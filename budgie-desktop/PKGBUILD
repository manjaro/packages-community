# Maintainer: Ricardo Vieira <ricardo.vieira@tecnico.ulisboa.pt>

pkgname=budgie-desktop
pkgver=10.2.4
pkgrel=1
pkgdesc="Simple GTK3 desktop experience"
arch=('i686' 'x86_64')
url="https://solus-project.com/budgie"
license=('GPLv2')

depends=('gtk3>=3.18' 'upower' 'libwnck3' 'gnome-menus' 'gnome-settings-daemon'
         'libpeas' 'mutter>=3.18' 'desktop-file-utils' 'libpulse' 'vala' 'libgee'
         'gnome-themes-standard' 'gnome-control-center' 'gnome-session>=3.18'
         'intltool' 'gnome-terminal' 'nautilus' 'gtk-doc')
makedepends=('autoconf' 'git' 'python2' 'gobject-introspection' 'intltool')
install=budgie-desktop.install

source=(#"$pkgname"::'git+https://github.com/solus-project/budgie-desktop.git#branch=master'
	"$pkgname-$pkgver.tar.gz::https://github.com/solus-project/budgie-desktop/archive/v${pkgver}.tar.gz"
	'git+https://git.gnome.org/browse/libgnome-volume-control#commit=7e5504d')
md5sums=('60e0f0504c0efe324b21c93764541091'
         'SKIP')

#pkgver() {
#  cd "$pkgname"
#  git describe --long | sed 's/^v//;s/\([^-]*-g\)/r\1/;s/-/./g'
#}

prepare() {
	mv $pkgname-$pkgver "$srcdir"/$pkgname
	cd "$srcdir"/$pkgname
	rm -rv gvc
	mv ../libgnome-volume-control gvc
}

build() {
	cd "$srcdir/$pkgname"
	intltoolize --force
        gtkdocize || exit 1
	autoreconf --force --install
	./configure --prefix=/usr --sysconfdir=/etc
	make
}

check() {
	cd "$srcdir/$pkgname"
	make -k check
}

package() {
	cd "$srcdir/$pkgname"
	make DESTDIR="$pkgdir/" install
}
